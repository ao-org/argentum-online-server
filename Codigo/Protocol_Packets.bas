Attribute VB_Name = "Protocol_Packets"
Option Explicit

Public PacketList(0 To 333) As Long

Private Declare Function CallWindowProc Lib "user32.dll" Alias "CallWindowProcA" (ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal msg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long

Public Sub InitializePacketList()

    PacketList(ClientPacketID.LoginExistingChar) = GetAddress(AddressOf HandleLoginExistingChar)
    PacketList(ClientPacketID.LoginNewChar) = GetAddress(AddressOf HandleLoginNewChar)
    PacketList(ClientPacketID.ThrowDice) = GetAddress(AddressOf HandleThrowDice)
    PacketList(ClientPacketID.Talk) = GetAddress(AddressOf HandleTalk)
    PacketList(ClientPacketID.Yell) = GetAddress(AddressOf HandleYell)
    PacketList(ClientPacketID.Whisper) = GetAddress(AddressOf HandleWhisper)
    PacketList(ClientPacketID.Walk) = GetAddress(AddressOf HandleWalk)
    PacketList(ClientPacketID.RequestPositionUpdate) = GetAddress(AddressOf HandleRequestPositionUpdate)
    PacketList(ClientPacketID.Attack) = GetAddress(AddressOf HandleAttack)
    PacketList(ClientPacketID.PickUp) = GetAddress(AddressOf HandlePickUp)
    PacketList(ClientPacketID.SafeToggle) = GetAddress(AddressOf HandleSafeToggle)
    PacketList(ClientPacketID.PartySafeToggle) = GetAddress(AddressOf HandlePartySafeToggle)
    PacketList(ClientPacketID.RequestGuildLeaderInfo) = GetAddress(AddressOf HandleRequestGuildLeaderInfo)
    PacketList(ClientPacketID.RequestAtributes) = GetAddress(AddressOf HandleRequestAtributes)
    PacketList(ClientPacketID.RequestSkills) = GetAddress(AddressOf HandleRequestSkills)
    PacketList(ClientPacketID.RequestMiniStats) = GetAddress(AddressOf HandleRequestMiniStats)
    PacketList(ClientPacketID.CommerceEnd) = GetAddress(AddressOf HandleCommerceEnd)
    PacketList(ClientPacketID.UserCommerceEnd) = GetAddress(AddressOf HandleUserCommerceEnd)
    PacketList(ClientPacketID.BankEnd) = GetAddress(AddressOf HandleBankEnd)
    PacketList(ClientPacketID.UserCommerceOk) = GetAddress(AddressOf HandleUserCommerceOk)
    PacketList(ClientPacketID.UserCommerceReject) = GetAddress(AddressOf HandleUserCommerceReject)
    PacketList(ClientPacketID.Drop) = GetAddress(AddressOf HandleDrop)
    PacketList(ClientPacketID.CastSpell) = GetAddress(AddressOf HandleCastSpell)
    PacketList(ClientPacketID.LeftClick) = GetAddress(AddressOf HandleLeftClick)
    PacketList(ClientPacketID.DoubleClick) = GetAddress(AddressOf HandleDoubleClick)
    PacketList(ClientPacketID.Work) = GetAddress(AddressOf HandleWork)
    PacketList(ClientPacketID.UseSpellMacro) = GetAddress(AddressOf HandleUseSpellMacro)
    PacketList(ClientPacketID.UseItem) = GetAddress(AddressOf HandleUseItem)
    PacketList(ClientPacketID.CraftBlacksmith) = GetAddress(AddressOf HandleCraftBlacksmith)
    PacketList(ClientPacketID.CraftCarpenter) = GetAddress(AddressOf HandleCraftCarpenter)
    PacketList(ClientPacketID.WorkLeftClick) = GetAddress(AddressOf HandleWorkLeftClick)
    PacketList(ClientPacketID.CreateNewGuild) = GetAddress(AddressOf HandleCreateNewGuild)
    PacketList(ClientPacketID.SpellInfo) = GetAddress(AddressOf HandleSpellInfo)
    PacketList(ClientPacketID.EquipItem) = GetAddress(AddressOf HandleEquipItem)
    PacketList(ClientPacketID.ChangeHeading) = GetAddress(AddressOf HandleChangeHeading)
    PacketList(ClientPacketID.ModifySkills) = GetAddress(AddressOf HandleModifySkills)
    PacketList(ClientPacketID.Train) = GetAddress(AddressOf HandleTrain)
    PacketList(ClientPacketID.CommerceBuy) = GetAddress(AddressOf HandleCommerceBuy)
    PacketList(ClientPacketID.BankExtractItem) = GetAddress(AddressOf HandleBankExtractItem)
    PacketList(ClientPacketID.CommerceSell) = GetAddress(AddressOf HandleCommerceSell)
    PacketList(ClientPacketID.BankDeposit) = GetAddress(AddressOf HandleBankDeposit)
    PacketList(ClientPacketID.ForumPost) = GetAddress(AddressOf HandleForumPost)
    PacketList(ClientPacketID.MoveSpell) = GetAddress(AddressOf HandleMoveSpell)
    PacketList(ClientPacketID.ClanCodexUpdate) = GetAddress(AddressOf HandleClanCodexUpdate)
    PacketList(ClientPacketID.UserCommerceOffer) = GetAddress(AddressOf HandleUserCommerceOffer)
    PacketList(ClientPacketID.GuildAcceptPeace) = GetAddress(AddressOf HandleGuildAcceptPeace)
    PacketList(ClientPacketID.GuildRejectAlliance) = GetAddress(AddressOf HandleGuildRejectAlliance)
    PacketList(ClientPacketID.GuildRejectPeace) = GetAddress(AddressOf HandleGuildRejectPeace)
    PacketList(ClientPacketID.GuildAcceptAlliance) = GetAddress(AddressOf HandleGuildAcceptAlliance)
    PacketList(ClientPacketID.GuildOfferPeace) = GetAddress(AddressOf HandleGuildOfferPeace)
    PacketList(ClientPacketID.GuildOfferAlliance) = GetAddress(AddressOf HandleGuildOfferAlliance)
    PacketList(ClientPacketID.GuildAllianceDetails) = GetAddress(AddressOf HandleGuildAllianceDetails)
    PacketList(ClientPacketID.GuildPeaceDetails) = GetAddress(AddressOf HandleGuildPeaceDetails)
    PacketList(ClientPacketID.GuildRequestJoinerInfo) = GetAddress(AddressOf HandleGuildRequestJoinerInfo)
    PacketList(ClientPacketID.GuildAlliancePropList) = GetAddress(AddressOf HandleGuildAlliancePropList)
    PacketList(ClientPacketID.GuildPeacePropList) = GetAddress(AddressOf HandleGuildPeacePropList)
    PacketList(ClientPacketID.GuildDeclareWar) = GetAddress(AddressOf HandleGuildDeclareWar)
    PacketList(ClientPacketID.GuildNewWebsite) = GetAddress(AddressOf HandleGuildNewWebsite)
    PacketList(ClientPacketID.GuildAcceptNewMember) = GetAddress(AddressOf HandleGuildAcceptNewMember)
    PacketList(ClientPacketID.GuildRejectNewMember) = GetAddress(AddressOf HandleGuildRejectNewMember)
    PacketList(ClientPacketID.GuildKickMember) = GetAddress(AddressOf HandleGuildKickMember)
    PacketList(ClientPacketID.GuildUpdateNews) = GetAddress(AddressOf HandleGuildUpdateNews)
    PacketList(ClientPacketID.GuildMemberInfo) = GetAddress(AddressOf HandleGuildMemberInfo)
    PacketList(ClientPacketID.GuildOpenElections) = GetAddress(AddressOf HandleGuildOpenElections)
    PacketList(ClientPacketID.GuildRequestMembership) = GetAddress(AddressOf HandleGuildRequestMembership)
    PacketList(ClientPacketID.GuildRequestDetails) = GetAddress(AddressOf HandleGuildRequestDetails)
    PacketList(ClientPacketID.Online) = GetAddress(AddressOf HandleOnline)
    PacketList(ClientPacketID.Quit) = GetAddress(AddressOf HandleQuit)
    PacketList(ClientPacketID.GuildLeave) = GetAddress(AddressOf HandleGuildLeave)
    PacketList(ClientPacketID.RequestAccountState) = GetAddress(AddressOf HandleRequestAccountState)
    PacketList(ClientPacketID.PetStand) = GetAddress(AddressOf HandlePetStand)
    PacketList(ClientPacketID.PetFollow) = GetAddress(AddressOf HandlePetFollow)
    PacketList(ClientPacketID.PetLeave) = GetAddress(AddressOf HandlePetLeave)
    PacketList(ClientPacketID.GrupoMsg) = GetAddress(AddressOf HandleGrupoMsg)
    PacketList(ClientPacketID.TrainList) = GetAddress(AddressOf HandleTrainList)
    PacketList(ClientPacketID.Rest) = GetAddress(AddressOf HandleRest)
    PacketList(ClientPacketID.Meditate) = GetAddress(AddressOf HandleMeditate)
    PacketList(ClientPacketID.Resucitate) = GetAddress(AddressOf HandleResucitate)
    PacketList(ClientPacketID.Heal) = GetAddress(AddressOf HandleHeal)
    PacketList(ClientPacketID.Help) = GetAddress(AddressOf HandleHelp)
    PacketList(ClientPacketID.RequestStats) = GetAddress(AddressOf HandleRequestStats)
    PacketList(ClientPacketID.CommerceStart) = GetAddress(AddressOf HandleCommerceStart)
    PacketList(ClientPacketID.BankStart) = GetAddress(AddressOf HandleBankStart)
    PacketList(ClientPacketID.Enlist) = GetAddress(AddressOf HandleEnlist)
    PacketList(ClientPacketID.Information) = GetAddress(AddressOf HandleInformation)
    PacketList(ClientPacketID.Reward) = GetAddress(AddressOf HandleReward)
    PacketList(ClientPacketID.RequestMOTD) = GetAddress(AddressOf HandleRequestMOTD)
    PacketList(ClientPacketID.UpTime) = GetAddress(AddressOf HandleUpTime)
    PacketList(ClientPacketID.Inquiry) = GetAddress(AddressOf HandleInquiry)
    PacketList(ClientPacketID.GuildMessage) = GetAddress(AddressOf HandleGuildMessage)
    PacketList(ClientPacketID.CentinelReport) = GetAddress(AddressOf HandleCentinelReport)
    PacketList(ClientPacketID.GuildOnline) = GetAddress(AddressOf HandleGuildOnline)
    PacketList(ClientPacketID.CouncilMessage) = GetAddress(AddressOf HandleCouncilMessage)
    PacketList(ClientPacketID.RoleMasterRequest) = GetAddress(AddressOf HandleRoleMasterRequest)
    PacketList(ClientPacketID.GMRequest) = GetAddress(AddressOf HandleGMRequest)
    PacketList(ClientPacketID.ChangeDescription) = GetAddress(AddressOf HandleChangeDescription)
    PacketList(ClientPacketID.GuildVote) = GetAddress(AddressOf HandleGuildVote)
    PacketList(ClientPacketID.punishments) = GetAddress(AddressOf HandlePunishments)
    PacketList(ClientPacketID.ChangePassword) = GetAddress(AddressOf HandleChangePassword)
    PacketList(ClientPacketID.Gamble) = GetAddress(AddressOf HandleGamble)
    PacketList(ClientPacketID.InquiryVote) = GetAddress(AddressOf HandleInquiryVote)
    PacketList(ClientPacketID.LeaveFaction) = GetAddress(AddressOf HandleLeaveFaction)
    PacketList(ClientPacketID.BankExtractGold) = GetAddress(AddressOf HandleBankExtractGold)
    PacketList(ClientPacketID.BankDepositGold) = GetAddress(AddressOf HandleBankDepositGold)
    PacketList(ClientPacketID.Denounce) = GetAddress(AddressOf HandleDenounce)
    PacketList(ClientPacketID.Ping) = GetAddress(AddressOf HandlePing)

    ' GM messages
    PacketList(ClientPacketID.GMMessage) = GetAddress(AddressOf HandleGMMessage)
    PacketList(ClientPacketID.showName) = GetAddress(AddressOf HandleShowName)
    PacketList(ClientPacketID.OnlineRoyalArmy) = GetAddress(AddressOf HandleOnlineRoyalArmy)
    PacketList(ClientPacketID.OnlineChaosLegion) = GetAddress(AddressOf HandleOnlineChaosLegion)
    PacketList(ClientPacketID.GoNearby) = GetAddress(AddressOf HandleGoNearby)
    PacketList(ClientPacketID.comment) = GetAddress(AddressOf HandleComment)
    PacketList(ClientPacketID.serverTime) = GetAddress(AddressOf HandleServerTime)
    PacketList(ClientPacketID.Where) = GetAddress(AddressOf HandleWhere)
    PacketList(ClientPacketID.CreaturesInMap) = GetAddress(AddressOf HandleCreaturesInMap)
    PacketList(ClientPacketID.WarpMeToTarget) = GetAddress(AddressOf HandleWarpMeToTarget)
    PacketList(ClientPacketID.WarpChar) = GetAddress(AddressOf HandleWarpChar)
    PacketList(ClientPacketID.Silence) = GetAddress(AddressOf HandleSilence)
    PacketList(ClientPacketID.SOSShowList) = GetAddress(AddressOf HandleSOSShowList)
    PacketList(ClientPacketID.SOSRemove) = GetAddress(AddressOf HandleSOSRemove)
    PacketList(ClientPacketID.GoToChar) = GetAddress(AddressOf HandleGoToChar)
    PacketList(ClientPacketID.invisible) = GetAddress(AddressOf HandleInvisible)
    PacketList(ClientPacketID.GMPanel) = GetAddress(AddressOf HandleGMPanel)
    PacketList(ClientPacketID.RequestUserList) = GetAddress(AddressOf HandleRequestUserList)
    PacketList(ClientPacketID.Working) = GetAddress(AddressOf HandleWorking)
    PacketList(ClientPacketID.Hiding) = GetAddress(AddressOf HandleHiding)
    PacketList(ClientPacketID.Jail) = GetAddress(AddressOf HandleJail)
    PacketList(ClientPacketID.KillNPC) = GetAddress(AddressOf HandleKillNPC)
    PacketList(ClientPacketID.WarnUser) = GetAddress(AddressOf HandleWarnUser)
    PacketList(ClientPacketID.EditChar) = GetAddress(AddressOf HandleEditChar)
    PacketList(ClientPacketID.RequestCharInfo) = GetAddress(AddressOf HandleRequestCharInfo)
    PacketList(ClientPacketID.RequestCharStats) = GetAddress(AddressOf HandleRequestCharStats)
    PacketList(ClientPacketID.RequestCharGold) = GetAddress(AddressOf HandleRequestCharGold)
    PacketList(ClientPacketID.RequestCharInventory) = GetAddress(AddressOf HandleRequestCharInventory)
    PacketList(ClientPacketID.RequestCharBank) = GetAddress(AddressOf HandleRequestCharBank)
    PacketList(ClientPacketID.RequestCharSkills) = GetAddress(AddressOf HandleRequestCharSkills)
    PacketList(ClientPacketID.ReviveChar) = GetAddress(AddressOf HandleReviveChar)
    PacketList(ClientPacketID.OnlineGM) = GetAddress(AddressOf HandleOnlineGM)
    PacketList(ClientPacketID.OnlineMap) = GetAddress(AddressOf HandleOnlineMap)
    PacketList(ClientPacketID.Forgive) = GetAddress(AddressOf HandleForgive)
    PacketList(ClientPacketID.Kick) = GetAddress(AddressOf HandleKick)
    PacketList(ClientPacketID.Execute) = GetAddress(AddressOf HandleExecute)
    PacketList(ClientPacketID.BanChar) = GetAddress(AddressOf HandleBanChar)
    PacketList(ClientPacketID.UnbanChar) = GetAddress(AddressOf HandleUnbanChar)
    PacketList(ClientPacketID.NPCFollow) = GetAddress(AddressOf HandleNPCFollow)
    PacketList(ClientPacketID.SummonChar) = GetAddress(AddressOf HandleSummonChar)
    PacketList(ClientPacketID.SpawnListRequest) = GetAddress(AddressOf HandleSpawnListRequest)
    PacketList(ClientPacketID.SpawnCreature) = GetAddress(AddressOf HandleSpawnCreature)
    PacketList(ClientPacketID.ResetNPCInventory) = GetAddress(AddressOf HandleResetNPCInventory)
    PacketList(ClientPacketID.CleanWorld) = GetAddress(AddressOf HandleCleanWorld)
    PacketList(ClientPacketID.ServerMessage) = GetAddress(AddressOf HandleServerMessage)
    PacketList(ClientPacketID.NickToIP) = GetAddress(AddressOf HandleNickToIP)
    PacketList(ClientPacketID.IPToNick) = GetAddress(AddressOf HandleIPToNick)
    PacketList(ClientPacketID.GuildOnlineMembers) = GetAddress(AddressOf HandleGuildOnlineMembers)
    PacketList(ClientPacketID.TeleportCreate) = GetAddress(AddressOf HandleTeleportCreate)
    PacketList(ClientPacketID.TeleportDestroy) = GetAddress(AddressOf HandleTeleportDestroy)
    PacketList(ClientPacketID.RainToggle) = GetAddress(AddressOf HandleRainToggle)
    PacketList(ClientPacketID.SetCharDescription) = GetAddress(AddressOf HandleSetCharDescription)
    PacketList(ClientPacketID.ForceMIDIToMap) = GetAddress(AddressOf HandleForceMIDIToMap)
    PacketList(ClientPacketID.ForceWAVEToMap) = GetAddress(AddressOf HandleForceWAVEToMap)
    PacketList(ClientPacketID.RoyalArmyMessage) = GetAddress(AddressOf HandleRoyalArmyMessage)
    PacketList(ClientPacketID.ChaosLegionMessage) = GetAddress(AddressOf HandleChaosLegionMessage)
    PacketList(ClientPacketID.CitizenMessage) = GetAddress(AddressOf HandleCitizenMessage)
    PacketList(ClientPacketID.CriminalMessage) = GetAddress(AddressOf HandleCriminalMessage)
    PacketList(ClientPacketID.TalkAsNPC) = GetAddress(AddressOf HandleTalkAsNPC)
    PacketList(ClientPacketID.DestroyAllItemsInArea) = GetAddress(AddressOf HandleDestroyAllItemsInArea)
    PacketList(ClientPacketID.AcceptRoyalCouncilMember) = GetAddress(AddressOf HandleAcceptRoyalCouncilMember)
    PacketList(ClientPacketID.AcceptChaosCouncilMember) = GetAddress(AddressOf HandleAcceptChaosCouncilMember)
    PacketList(ClientPacketID.ItemsInTheFloor) = GetAddress(AddressOf HandleItemsInTheFloor)
    PacketList(ClientPacketID.MakeDumb) = GetAddress(AddressOf HandleMakeDumb)
    PacketList(ClientPacketID.MakeDumbNoMore) = GetAddress(AddressOf HandleMakeDumbNoMore)
    PacketList(ClientPacketID.DumpIPTables) = GetAddress(AddressOf HandleDumpIPTables)
    PacketList(ClientPacketID.CouncilKick) = GetAddress(AddressOf HandleCouncilKick)
    PacketList(ClientPacketID.SetTrigger) = GetAddress(AddressOf HandleSetTrigger)
    PacketList(ClientPacketID.AskTrigger) = GetAddress(AddressOf HandleAskTrigger)
    PacketList(ClientPacketID.BannedIPList) = GetAddress(AddressOf HandleBannedIPList)
    PacketList(ClientPacketID.BannedIPReload) = GetAddress(AddressOf HandleBannedIPReload)
    PacketList(ClientPacketID.GuildMemberList) = GetAddress(AddressOf HandleGuildMemberList)
    PacketList(ClientPacketID.GuildBan) = GetAddress(AddressOf HandleGuildBan)
    PacketList(ClientPacketID.banip) = GetAddress(AddressOf HandleBanIP)
    PacketList(ClientPacketID.UnbanIP) = GetAddress(AddressOf HandleUnbanIP)
    PacketList(ClientPacketID.CreateItem) = GetAddress(AddressOf HandleCreateItem)
    PacketList(ClientPacketID.DestroyItems) = GetAddress(AddressOf HandleDestroyItems)
    PacketList(ClientPacketID.ChaosLegionKick) = GetAddress(AddressOf HandleChaosLegionKick)
    PacketList(ClientPacketID.RoyalArmyKick) = GetAddress(AddressOf HandleRoyalArmyKick)
    PacketList(ClientPacketID.ForceMIDIAll) = GetAddress(AddressOf HandleForceMIDIAll)
    PacketList(ClientPacketID.ForceWAVEAll) = GetAddress(AddressOf HandleForceWAVEAll)
    PacketList(ClientPacketID.RemovePunishment) = GetAddress(AddressOf HandleRemovePunishment)
    PacketList(ClientPacketID.TileBlockedToggle) = GetAddress(AddressOf HandleTileBlockedToggle)
    PacketList(ClientPacketID.KillNPCNoRespawn) = GetAddress(AddressOf HandleKillNPCNoRespawn)
    PacketList(ClientPacketID.KillAllNearbyNPCs) = GetAddress(AddressOf HandleKillAllNearbyNPCs)
    PacketList(ClientPacketID.LastIP) = GetAddress(AddressOf HandleLastIP)
    PacketList(ClientPacketID.ChangeMOTD) = GetAddress(AddressOf HandleChangeMOTD)
    PacketList(ClientPacketID.SetMOTD) = GetAddress(AddressOf HandleSetMOTD)
    PacketList(ClientPacketID.SystemMessage) = GetAddress(AddressOf HandleSystemMessage)
    PacketList(ClientPacketID.CreateNPC) = GetAddress(AddressOf HandleCreateNPC)
    PacketList(ClientPacketID.CreateNPCWithRespawn) = GetAddress(AddressOf HandleCreateNPCWithRespawn)
    PacketList(ClientPacketID.ImperialArmour) = GetAddress(AddressOf HandleImperialArmour)
    PacketList(ClientPacketID.ChaosArmour) = GetAddress(AddressOf HandleChaosArmour)
    PacketList(ClientPacketID.NavigateToggle) = GetAddress(AddressOf HandleNavigateToggle)
    PacketList(ClientPacketID.ServerOpenToUsersToggle) = GetAddress(AddressOf HandleServerOpenToUsersToggle)
    PacketList(ClientPacketID.Participar) = GetAddress(AddressOf HandleParticipar)
    PacketList(ClientPacketID.TurnCriminal) = GetAddress(AddressOf HandleTurnCriminal)
    PacketList(ClientPacketID.ResetFactions) = GetAddress(AddressOf HandleResetFactions)
    PacketList(ClientPacketID.RemoveCharFromGuild) = GetAddress(AddressOf HandleRemoveCharFromGuild)
    PacketList(ClientPacketID.RequestCharMail) = GetAddress(AddressOf HandleRequestCharMail)
    PacketList(ClientPacketID.AlterPassword) = GetAddress(AddressOf HandleAlterPassword)
    PacketList(ClientPacketID.AlterMail) = GetAddress(AddressOf HandleAlterMail)
    PacketList(ClientPacketID.AlterName) = GetAddress(AddressOf HandleAlterName)
    PacketList(ClientPacketID.DoBackUp) = GetAddress(AddressOf HandleDoBackUp)
    PacketList(ClientPacketID.ShowGuildMessages) = GetAddress(AddressOf HandleShowGuildMessages)
    PacketList(ClientPacketID.SaveMap) = GetAddress(AddressOf HandleSaveMap)
    PacketList(ClientPacketID.ChangeMapInfoPK) = GetAddress(AddressOf HandleChangeMapInfoPK)
    PacketList(ClientPacketID.ChangeMapInfoBackup) = GetAddress(AddressOf HandleChangeMapInfoBackup)
    PacketList(ClientPacketID.ChangeMapInfoRestricted) = GetAddress(AddressOf HandleChangeMapInfoRestricted)
    PacketList(ClientPacketID.ChangeMapInfoNoMagic) = GetAddress(AddressOf HandleChangeMapInfoNoMagic)
    PacketList(ClientPacketID.ChangeMapInfoNoInvi) = GetAddress(AddressOf HandleChangeMapInfoNoInvi)
    PacketList(ClientPacketID.ChangeMapInfoNoResu) = GetAddress(AddressOf HandleChangeMapInfoNoResu)
    PacketList(ClientPacketID.ChangeMapInfoLand) = GetAddress(AddressOf HandleChangeMapInfoLand)
    PacketList(ClientPacketID.ChangeMapInfoZone) = GetAddress(AddressOf HandleChangeMapInfoZone)
    PacketList(ClientPacketID.SaveChars) = GetAddress(AddressOf HandleSaveChars)
    PacketList(ClientPacketID.CleanSOS) = GetAddress(AddressOf HandleCleanSOS)
    PacketList(ClientPacketID.ShowServerForm) = GetAddress(AddressOf HandleShowServerForm)
    PacketList(ClientPacketID.night) = GetAddress(AddressOf HandleNight)
    PacketList(ClientPacketID.KickAllChars) = GetAddress(AddressOf HandleKickAllChars)
    PacketList(ClientPacketID.RequestTCPStats) = GetAddress(AddressOf HandleRequestTCPStats)
    PacketList(ClientPacketID.ReloadNPCs) = GetAddress(AddressOf HandleReloadNPCs)
    PacketList(ClientPacketID.ReloadServerIni) = GetAddress(AddressOf HandleReloadServerIni)
    PacketList(ClientPacketID.ReloadSpells) = GetAddress(AddressOf HandleReloadSpells)
    PacketList(ClientPacketID.ReloadObjects) = GetAddress(AddressOf HandleReloadObjects)
    PacketList(ClientPacketID.Restart) = GetAddress(AddressOf HandleRestart)
    PacketList(ClientPacketID.ResetAutoUpdate) = GetAddress(AddressOf HandleResetAutoUpdate)
    PacketList(ClientPacketID.ChatColor) = GetAddress(AddressOf HandleChatColor)
    PacketList(ClientPacketID.Ignored) = GetAddress(AddressOf HandleIgnored)
    PacketList(ClientPacketID.CheckSlot) = GetAddress(AddressOf HandleCheckSlot)

    ' Nuevas Ladder
    PacketList(ClientPacketID.GlobalMessage) = GetAddress(AddressOf HandleGlobalMessage)
    PacketList(ClientPacketID.GlobalOnOff) = GetAddress(AddressOf HandleGlobalOnOff)
    PacketList(ClientPacketID.IngresarConCuenta) = GetAddress(AddressOf HandleIngresarConCuenta)
    PacketList(ClientPacketID.BorrarPJ) = GetAddress(AddressOf HandleBorrarPJ)
    PacketList(ClientPacketID.NewPacketID) = GetAddress(AddressOf HandleNewPacketID)
    PacketList(ClientPacketID.Desbuggear) = GetAddress(AddressOf HandleDesbuggear)
    PacketList(ClientPacketID.DarLlaveAUsuario) = GetAddress(AddressOf HandleDarLlaveAUsuario)
    PacketList(ClientPacketID.SacarLlave) = GetAddress(AddressOf HandleSacarLlave)
    PacketList(ClientPacketID.VerLlaves) = GetAddress(AddressOf HandleVerLlaves)
    PacketList(ClientPacketID.UseKey) = GetAddress(AddressOf HandleUseKey)
    PacketList(ClientPacketID.Day) = GetAddress(AddressOf HandleDay)
    PacketList(ClientPacketID.SetTime) = GetAddress(AddressOf HandleSetTime)
    PacketList(ClientPacketID.DonateGold) = GetAddress(AddressOf HandleDonateGold)
    PacketList(ClientPacketID.Promedio) = GetAddress(AddressOf HandlePromedio)
    PacketList(ClientPacketID.GiveItem) = GetAddress(AddressOf HandleGiveItem)
    PacketList(ClientPacketID.OfertaInicial) = GetAddress(AddressOf HandleOfertaInicial)
    PacketList(ClientPacketID.OfertaDeSubasta) = GetAddress(AddressOf HandleOfertaDeSubasta)
    PacketList(ClientPacketID.QuestionGM) = GetAddress(AddressOf HandleQuestionGM)
    PacketList(ClientPacketID.CuentaRegresiva) = GetAddress(AddressOf HandleCuentaRegresiva)
    PacketList(ClientPacketID.PossUser) = GetAddress(AddressOf HandlePossUser)
    PacketList(ClientPacketID.Duel) = GetAddress(AddressOf HandleDuel)
    PacketList(ClientPacketID.AcceptDuel) = GetAddress(AddressOf HandleAcceptDuel)
    PacketList(ClientPacketID.CancelDuel) = GetAddress(AddressOf HandleCancelDuel)
    PacketList(ClientPacketID.QuitDuel) = GetAddress(AddressOf HandleQuitDuel)
    PacketList(ClientPacketID.NieveToggle) = GetAddress(AddressOf HandleNieveToggle)
    PacketList(ClientPacketID.NieblaToggle) = GetAddress(AddressOf HandleNieblaToggle)
    PacketList(ClientPacketID.TransFerGold) = GetAddress(AddressOf HandleTransFerGold)
    PacketList(ClientPacketID.Moveitem) = GetAddress(AddressOf HandleMoveItem)
    PacketList(ClientPacketID.Genio) = GetAddress(AddressOf HandleGenio)
    PacketList(ClientPacketID.Casarse) = GetAddress(AddressOf HandleCasarse)
    PacketList(ClientPacketID.CraftAlquimista) = GetAddress(AddressOf HandleCraftAlquimista)
    PacketList(ClientPacketID.RequestFamiliar) = GetAddress(AddressOf HandleRequestFamiliar)
    PacketList(ClientPacketID.FlagTrabajar) = GetAddress(AddressOf HandleFlagTrabajar)
    PacketList(ClientPacketID.CraftSastre) = GetAddress(AddressOf HandleCraftSastre)
    PacketList(ClientPacketID.MensajeUser) = GetAddress(AddressOf HandleMensajeUser)
    PacketList(ClientPacketID.TraerBoveda) = GetAddress(AddressOf HandleTraerBoveda)
    PacketList(ClientPacketID.CompletarAccion) = GetAddress(AddressOf HandleCompletarAccion)
    PacketList(ClientPacketID.Escribiendo) = GetAddress(AddressOf HandleEscribiendo)
    PacketList(ClientPacketID.TraerRecompensas) = GetAddress(AddressOf HandleTraerRecompensas)
    PacketList(ClientPacketID.ReclamarRecompensa) = GetAddress(AddressOf HandleReclamarRecompensa)
    PacketList(ClientPacketID.Correo) = GetAddress(AddressOf HandleCorreo)
    PacketList(ClientPacketID.SendCorreo) = GetAddress(AddressOf HandleSendCorreo)
    PacketList(ClientPacketID.RetirarItemCorreo) = GetAddress(AddressOf HandleRetirarItemCorreo)
    PacketList(ClientPacketID.BorrarCorreo) = GetAddress(AddressOf HandleBorrarCorreo)
    PacketList(ClientPacketID.InvitarGrupo) = GetAddress(AddressOf HandleInvitarGrupo)
    PacketList(ClientPacketID.ResponderPregunta) = GetAddress(AddressOf HandleResponderPregunta)
    PacketList(ClientPacketID.RequestGrupo) = GetAddress(AddressOf HandleRequestGrupo)
    PacketList(ClientPacketID.AbandonarGrupo) = GetAddress(AddressOf HandleAbandonarGrupo)
    PacketList(ClientPacketID.HecharDeGrupo) = GetAddress(AddressOf HandleHecharDeGrupo)
    PacketList(ClientPacketID.MacroPossent) = GetAddress(AddressOf HandleMacroPossent)
    PacketList(ClientPacketID.SubastaInfo) = GetAddress(AddressOf HandleSubastaInfo)
    PacketList(ClientPacketID.bancuenta) = GetAddress(AddressOf HandleBanCuenta)
    PacketList(ClientPacketID.unBanCuenta) = GetAddress(AddressOf HandleUnBanCuenta)
    PacketList(ClientPacketID.BanSerial) = GetAddress(AddressOf HandleBanSerial)
    PacketList(ClientPacketID.unBanSerial) = GetAddress(AddressOf HandleUnBanSerial)
    PacketList(ClientPacketID.CerrarCliente) = GetAddress(AddressOf HandleCerrarCliente)
    PacketList(ClientPacketID.EventoInfo) = GetAddress(AddressOf HandleEventoInfo)
    PacketList(ClientPacketID.CrearEvento) = GetAddress(AddressOf HandleCrearEvento)
    PacketList(ClientPacketID.BanTemporal) = GetAddress(AddressOf HandleBanTemporal)
    PacketList(ClientPacketID.Traershop) = GetAddress(AddressOf HandleTraerShop)
    PacketList(ClientPacketID.ComprarItem) = GetAddress(AddressOf HandleComprarItem)
    PacketList(ClientPacketID.ScrollInfo) = GetAddress(AddressOf HandleScrollInfo)
    PacketList(ClientPacketID.CancelarExit) = GetAddress(AddressOf HandleCancelarExit)
    PacketList(ClientPacketID.EnviarCodigo) = GetAddress(AddressOf HandleEnviarCodigo)
    PacketList(ClientPacketID.CrearTorneo) = GetAddress(AddressOf HandleCrearTorneo)
    PacketList(ClientPacketID.ComenzarTorneo) = GetAddress(AddressOf HandleComenzarTorneo)
    PacketList(ClientPacketID.CancelarTorneo) = GetAddress(AddressOf HandleCancelarTorneo)
    PacketList(ClientPacketID.BusquedaTesoro) = GetAddress(AddressOf HandleBusquedaTesoro)
    PacketList(ClientPacketID.CompletarViaje) = GetAddress(AddressOf HandleCompletarViaje)
    PacketList(ClientPacketID.BovedaMoveItem) = GetAddress(AddressOf HandleBovedaMoveItem)
    PacketList(ClientPacketID.QuieroFundarClan) = GetAddress(AddressOf HandleQuieroFundarClan)
    PacketList(ClientPacketID.LlamadadeClan) = GetAddress(AddressOf HandleLlamadadeClan)
    PacketList(ClientPacketID.MarcaDeClanPack) = GetAddress(AddressOf HandleMarcaDeClanPack)
    PacketList(ClientPacketID.MarcaDeGMPack) = GetAddress(AddressOf HandleMarcaDeGMPack)
    PacketList(ClientPacketID.TraerRanking) = GetAddress(AddressOf HandleTraerRanking)
    PacketList(ClientPacketID.Pareja) = GetAddress(AddressOf HandlePareja)
    PacketList(ClientPacketID.Quest) = GetAddress(AddressOf HandleQuest)
    PacketList(ClientPacketID.QuestAccept) = GetAddress(AddressOf HandleQuestAccept)
    PacketList(ClientPacketID.QuestListRequest) = GetAddress(AddressOf HandleQuestListRequest)
    PacketList(ClientPacketID.QuestDetailsRequest) = GetAddress(AddressOf HandleQuestDetailsRequest)
    PacketList(ClientPacketID.QuestAbandon) = GetAddress(AddressOf HandleQuestAbandon)
    PacketList(ClientPacketID.SeguroClan) = GetAddress(AddressOf HandleSeguroClan)
    PacketList(ClientPacketID.CreatePretorianClan) = GetAddress(AddressOf HandleCreatePretorianClan)
    PacketList(ClientPacketID.RemovePretorianClan) = GetAddress(AddressOf HandleRemovePretorianClan)
    PacketList(ClientPacketID.Home) = GetAddress(AddressOf HandleHome)
    PacketList(ClientPacketID.Consulta) = GetAddress(AddressOf HandleConsulta)
    PacketList(ClientPacketID.RequestScreenShot) = GetAddress(AddressOf HandleRequestScreenShot)
    PacketList(ClientPacketID.RequestProcesses) = GetAddress(AddressOf HandleRequestProcesses)
    PacketList(ClientPacketID.SendScreenShot) = GetAddress(AddressOf HandleSendScreenShot)
    PacketList(ClientPacketID.SendProcesses) = GetAddress(AddressOf HandleSendProcesses)
    PacketList(ClientPacketID.Tolerancia0) = GetAddress(AddressOf HandleTolerancia0)
    PacketList(ClientPacketID.GetMapInfo) = GetAddress(AddressOf HandleGetMapInfo)
    PacketList(ClientPacketID.FinEvento) = GetAddress(AddressOf HandleFinEvento)
    PacketList(ClientPacketID.SeguroResu) = GetAddress(AddressOf HandleSeguroResu)
    PacketList(ClientPacketID.CuentaExtractItem) = GetAddress(AddressOf HandleCuentaExtractItem)
    PacketList(ClientPacketID.CuentaDeposit) = GetAddress(AddressOf HandleCuentaDeposit)
    PacketList(ClientPacketID.CreateEvent) = GetAddress(AddressOf HandleCreateEvent)
    PacketList(ClientPacketID.CommerceSendChatMessage) = GetAddress(AddressOf HandleCommerceSendChatMessage)
    PacketList(ClientPacketID.LogMacroClickHechizo) = GetAddress(AddressOf HandleLogMacroClickHechizo)

End Sub

Public Sub Parse(ByVal packetIndex As Long)
        
     If packetIndex > UBound(PacketList()) Then Exit Sub
       
    'TODO: me parece que los handles no podrían
    'tener más de 4 argumentos (cada 0& es un argumento),
    'igual esto se puede obviar utilizando un poco el protocolo
    'binario, le pasamos como paramétro el userindex y de
    'ahí obtenemos todos los datos o lo que sea
 
    'llamamos al sub mediante su dirección en memoria
    Call CallWindowProc(PacketList(packetIndex), 0&, 0&, 0&, 0&)
 
End Sub

'Devuelve el argumento que se le pasó (sirve para usar AddressOf en variables)
Public Function GetAddress(ByVal address As Long) As Long
 
    GetAddress = address
 
End Function
