diff --git a/Codigo/Declares.bas b/Codigo/Declares.bas
index 831fc65c8249a56c590031fd1ee5aaeb36dfbce3..88f8f09b369ee7a4fd28c85738b0ab1bea0460b6 100644
--- a/Codigo/Declares.bas
+++ b/Codigo/Declares.bas
@@ -5,50 +5,67 @@ Attribute VB_Name = "Declaraciones"
 '
 '    This program is free software: you can redistribute it and/or modify
 '    it under the terms of the GNU Affero General Public License as published by
 '    the Free Software Foundation, either version 3 of the License, or
 '    (at your option) any later version.
 '
 '    This program is distributed in the hope that it will be useful,
 '    but WITHOUT ANY WARRANTY; without even the implied warranty of
 '    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 '    GNU Affero General Public License for more details.
 '
 '    You should have received a copy of the GNU Affero General Public License
 '    along with this program.  If not, see <https://www.gnu.org/licenses/>.
 '
 '    This program was based on Argentum Online 0.11.6
 '    Copyright (C) 2002 Márquez Pablo Ignacio
 '
 '    Argentum Online is based on Baronsoft's VB6 Online RPG
 '    You can contact the original creator of ORE at aaron@baronsoft.com
 '    for more information about ORE please visit http://www.baronsoft.com/
 '
 '
 '
 Option Explicit
 
+' Identificadores de últimos mensajes para evitar repetición.
+Public Const LASTMSG_PARALYZED = 1
+Public Const LASTMSG_ALREADY_HIDDEN = 2
+Public Const LASTMSG_CANNOT_HIDE_MOUNTED = 3
+Public Const LASTMSG_HIDE_FAILED = 4
+Public Const LASTMSG_TAME_FAILED = 5
+Public Const LASTMSG_MAP_NEWBIE_ONLY = 101
+Public Const LASTMSG_MAP_ONLY_CITIZENS = 102
+Public Const LASTMSG_MAP_ONLY_CRIMINALS = 103
+Public Const LASTMSG_MAP_REQUIRES_CLAN = 104
+Public Const LASTMSG_MAP_MIN_LEVEL = 105
+Public Const LASTMSG_MAP_MAX_LEVEL = 106
+Public Const LASTMSG_MAP_REQUIRES_GROUP = 107
+Public Const LASTMSG_MAP_REQUIRES_PATREON = 107
+Public Const LASTMSG_TILE_REQUIRES_PATREON = 108
+Public Const LASTMSG_PICKUP_UNAVAILABLE = 261
+
 ''
 ' Modulo de declaraciones. Aca hay de todo.
 '
 Public Enum e_PotionType
     ModifiesAgility = 1
     ModifiesStrength = 2
     ModifiesHp = 3
     ModifiesMp = 4
     HealsPoison = 5
     HealsParalysis = 6
     ModifiesStamina = 7
     ModifiesHeadRandom = 8
     ModifiesSex = 9
     TurnsYouInvisible = 10
     'ScrollExperience = 11
     'ScrollGold = 12
     HealsAllStatusEffects = 13
     'libre = 14
     'ModifiesOxygen = 15
     ModifiesMarriage = 16
     ModifiesHeadRandomLegendary = 17
     ModifiesParticlesTemporary = 18
     'ResetSkills = 19
     'ExpandsInventory = 20
     SuicidePotion = 21
diff --git a/Codigo/GameLogic.bas b/Codigo/GameLogic.bas
index ac07ba348254026731813c5de9615bfa850f671f..bdb2eba1a334bafc93dfc79e5774ac25b3f6d9a6 100644
--- a/Codigo/GameLogic.bas
+++ b/Codigo/GameLogic.bas
@@ -195,110 +195,110 @@ Public Function FactionCanHelpFaction(ByVal SourceFaction As e_Facciones, ByVal
 End Function
 
 Public Function EsGM(ByVal UserIndex As Integer) As Boolean
     '***************************************************
     'Autor: Pablo (ToxicWaste)
     'Last Modification: 23/01/2007
     '***************************************************
     On Error GoTo EsGM_Err
     If UserIndex = 0 Then
         EsGM = False
         Exit Function
     End If
     EsGM = (UserList(UserIndex).flags.Privilegios And (e_PlayerType.Admin Or e_PlayerType.Dios Or e_PlayerType.SemiDios Or e_PlayerType.Consejero)) <> 0
     Exit Function
 EsGM_Err:
     Call TraceError(Err.Number, Err.Description, "Extra.EsGM", Erl)
 End Function
 
 Private Function CheckMapRestrictions(ByVal UserIndex As Integer, ByVal Map As Integer) As Boolean
     With UserList(UserIndex)
         If EsGM(UserIndex) Then
             CheckMapRestrictions = True
             Exit Function
         End If
         If MapInfo(Map).Newbie And Not EsNewbie(UserIndex) Then
-            If .flags.UltimoMensaje <> 101 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_NEWBIE_ONLY Then
                 ' Msg771=Sólo los newbies pueden entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 771, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 101
+                .flags.UltimoMensaje = LASTMSG_MAP_NEWBIE_ONLY
             End If
             Exit Function
         End If
         If MapInfo(Map).NoPKs And (Status(UserIndex) = 0 Or Status(UserIndex) = 2) Then
-            If .flags.UltimoMensaje <> 102 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_ONLY_CITIZENS Then
                 ' Msg772=Sólo los ciudadanos pueden entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 772, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 102
+                .flags.UltimoMensaje = LASTMSG_MAP_ONLY_CITIZENS
             End If
             Exit Function
         End If
         If MapInfo(Map).NoCiudadanos And (Status(UserIndex) = 1 Or Status(UserIndex) = 3) Then
-            If .flags.UltimoMensaje <> 103 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_ONLY_CRIMINALS Then
                 ' Msg773=Sólo los criminales pueden entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 773, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 103
+                .flags.UltimoMensaje = LASTMSG_MAP_ONLY_CRIMINALS
             End If
             Exit Function
         End If
         If MapInfo(Map).SoloClanes And .GuildIndex <= 0 Then
-            If .flags.UltimoMensaje <> 104 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_REQUIRES_CLAN Then
                 ' Msg774=Necesitas pertenecer a un clan para entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 774, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 104
+                .flags.UltimoMensaje = LASTMSG_MAP_REQUIRES_CLAN
             End If
             Exit Function
         End If
         If MapInfo(Map).MinLevel <> 0 And .Stats.ELV < MapInfo(Map).MinLevel Then
-            If .flags.UltimoMensaje <> 105 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_MIN_LEVEL Then
                 'Msg1108= Necesitas ser al menos nivel ¬1
                 Call WriteLocaleMsg(UserIndex, 1108, e_FontTypeNames.FONTTYPE_INFO, MapInfo(Map).MinLevel)
-                .flags.UltimoMensaje = 105
+                .flags.UltimoMensaje = LASTMSG_MAP_MIN_LEVEL
             End If
             Exit Function
         End If
         If MapInfo(Map).MaxLevel <> 0 And .Stats.ELV >= MapInfo(Map).MaxLevel Then
-            If .flags.UltimoMensaje <> 106 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_MAX_LEVEL Then
                 'Msg1109= Sólo los personajes inferiores a nivel ¬1
                 Call WriteLocaleMsg(UserIndex, 1109, e_FontTypeNames.FONTTYPE_INFO, MapInfo(Map).MaxLevel)
-                .flags.UltimoMensaje = 106
+                .flags.UltimoMensaje = LASTMSG_MAP_MAX_LEVEL
             End If
             Exit Function
         End If
         If MapInfo(Map).OnlyGroups And Not .Grupo.EnGrupo Then
-            If .flags.UltimoMensaje <> 107 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_REQUIRES_GROUP Then
                 ' Msg775=Necesitas pertenecer a un grupo para entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 775, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 107
+                .flags.UltimoMensaje = LASTMSG_MAP_REQUIRES_GROUP
             End If
             Exit Function
         End If
         If MapInfo(Map).OnlyPatreon And Not (.Stats.tipoUsuario = tAventurero Or .Stats.tipoUsuario = tHeroe Or .Stats.tipoUsuario = tLeyenda) Then
-            If .flags.UltimoMensaje <> 107 Then
+            If .flags.UltimoMensaje <> LASTMSG_MAP_REQUIRES_PATREON Then
                 ' Msg776=Necesitas ser Patreon para entrar a este mapa.
                 Call WriteLocaleMsg(UserIndex, 776, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 107
+                .flags.UltimoMensaje = LASTMSG_MAP_REQUIRES_PATREON
             End If
             Exit Function
         End If
         CheckMapRestrictions = True
     End With
 End Function
 
 Public Function GetTransportNextIndex(ByVal Map As Integer, ByVal PosX As Byte, ByVal PosY As Byte) As Integer
     Dim i As Integer
     With MapInfo(Map)
         For i = 0 To UBound(.TransportNetwork)
             If .TransportNetwork(i).TileX = PosX And .TransportNetwork(i).TileY = PosY Then
                 GetTransportNextIndex = i
                 Exit Function
             End If
         Next i
     End With
     GetTransportNextIndex = -1
 End Function
 
 Public Function GetExitTransport(ByVal Map As Integer, ByVal ExcludeIndex As Integer) As Integer
     Dim Output As Integer
     Do
         Output = RandomNumber(0, UBound(MapInfo(Map).TransportNetwork))
     Loop While Output = ExcludeIndex
@@ -832,53 +832,53 @@ Function LegalWalk(ByVal Map As Integer, _
     If y < MinYBorder Or y > MaxYBorder Then Exit Function
     With MapData(Map, x, y)
         If .NpcIndex <> 0 Then
             If Not IsSet(NpcList(.NpcIndex).flags.StatusMask, e_StatusMask.eDontBlockTile) Then Exit Function
         End If
         If .UserIndex <> 0 Then
             If UserList(.UserIndex).flags.AdminInvisible = 0 And UserList(.UserIndex).flags.Muerto = 0 Then
                 Exit Function
             End If
         End If
         If Not PuedeTraslado Then
             If .TileExit.Map > 0 Then Exit Function
         End If
         If Not PuedeAgua Then
             If (.Blocked And FLAG_AGUA) <> 0 And Not .trigger = e_Trigger.VALIDOPUENTE Then Exit Function
         End If
         If Not PuedeTierra Then
             If (.Blocked And FLAG_AGUA) = 0 Then Exit Function
         End If
         If .trigger = WORKERONLY Then
             If Not UserList(WalkerIndex).clase = Trabajador Then Exit Function
         End If
         If WalkerIndex <> 0 Then
             If TileRequiresPatreon(Map, x, y) Then
                 If Not EsGM(WalkerIndex) And Not IsPatreon(WalkerIndex) Then
-                    If UserList(WalkerIndex).flags.UltimoMensaje <> 108 Then
+                    If UserList(WalkerIndex).flags.UltimoMensaje <> LASTMSG_TILE_REQUIRES_PATREON Then
                         Call WriteLocaleMsg(WalkerIndex, 776, e_FontTypeNames.FONTTYPE_INFO)
-                        UserList(WalkerIndex).flags.UltimoMensaje = 108
+                        UserList(WalkerIndex).flags.UltimoMensaje = LASTMSG_TILE_REQUIRES_PATREON
                     End If
                     Exit Function
                 End If
             End If
         End If
         If (.Blocked And 2 ^ (Heading - 1)) <> 0 Then Exit Function
     End With
     LegalWalk = True
     Exit Function
 LegalWalk_Err:
     Call TraceError(Err.Number, Err.Description, "Extra.LegalWalk", Erl)
 End Function
 
 Function LegalPosNPC(ByVal Map As Integer, ByVal x As Integer, ByVal y As Integer, ByVal AguaValida As Byte, Optional ByVal IsPet As Boolean = False) As Boolean
     On Error GoTo LegalPosNPC_Err
     If (Map <= 0 Or Map > NumMaps) Or (x < MinXBorder Or x > MaxXBorder Or y < MinYBorder Or y > MaxYBorder) Then
         LegalPosNPC = False
     ElseIf MapData(Map, x, y).TileExit.Map > 0 Then
         LegalPosNPC = False
     Else
         If AguaValida = 0 Then
             LegalPosNPC = (MapData(Map, x, y).Blocked And e_Block.ALL_SIDES) <> e_Block.ALL_SIDES And (MapData(Map, x, y).UserIndex = 0) And (MapData(Map, x, y).NpcIndex = 0) _
                     And (MapData(Map, x, y).trigger <> e_Trigger.POSINVALIDA Or IsPet) And (MapData(Map, x, y).Blocked And FLAG_AGUA) = 0
         Else
             LegalPosNPC = (MapData(Map, x, y).Blocked And e_Block.ALL_SIDES) <> e_Block.ALL_SIDES And (MapData(Map, x, y).UserIndex = 0) And (MapData(Map, x, y).NpcIndex = 0) _
diff --git a/Codigo/InvUsuario.bas b/Codigo/InvUsuario.bas
index cb7d835754ac871d943c979e64d78068c268038c..0ee39564bfc325820e623e049ceb40a2754b56c3 100644
--- a/Codigo/InvUsuario.bas
+++ b/Codigo/InvUsuario.bas
@@ -621,53 +621,53 @@ Sub PickObj(ByVal UserIndex As Integer)
                 'Si el obj es oro (12), se muestra la cantidad que agarro arriba del personaje
                 If MiObj.ObjIndex = 12 Then
                     Call WriteTextOverTile(UserIndex, "+" & PonerPuntos(MiObj.amount), UserList(UserIndex).pos.x, UserList(UserIndex).pos.y, RGB(212, 175, 55))
                 End If
                 Call UserDidPickupItem(UserIndex, MiObj.ObjIndex)
                 If UserList(UserIndex).flags.jugando_captura = 1 Then
                     If Not InstanciaCaptura Is Nothing Then
                         Call InstanciaCaptura.quitarBandera(UserIndex, MiObj.ObjIndex)
                     End If
                 End If
                 If BusquedaTesoroActiva Then
                     If UserList(UserIndex).pos.Map = TesoroNumMapa And UserList(UserIndex).pos.x = TesoroX And UserList(UserIndex).pos.y = TesoroY Then
                         Call SendData(SendTarget.ToAll, 0, PrepareMessageLocaleMsg(1639, UserList(UserIndex).name, e_FontTypeNames.FONTTYPE_TALK)) 'Msg1640=Eventos> ¬1 encontró el tesoro ¡Felicitaciones!
                         BusquedaTesoroActiva = False
                     End If
                 End If
                 If BusquedaRegaloActiva Then
                     If UserList(UserIndex).pos.Map = RegaloNumMapa And UserList(UserIndex).pos.x = RegaloX And UserList(UserIndex).pos.y = RegaloY Then
                         Call SendData(SendTarget.ToAll, 0, PrepareMessageLocaleMsg(1640, UserList(UserIndex).name, e_FontTypeNames.FONTTYPE_TALK)) 'Msg1640=Eventos> ¬1 fue el valiente que encontró el gran ítem mágico ¡Felicitaciones!
                         BusquedaRegaloActiva = False
                     End If
                 End If
             End If
         End If
     Else
-        If Not UserList(UserIndex).flags.UltimoMensaje = 261 Then
+        If Not UserList(UserIndex).flags.UltimoMensaje = LASTMSG_PICKUP_UNAVAILABLE Then
             Call WriteLocaleMsg(UserIndex, 261, e_FontTypeNames.FONTTYPE_INFO)
-            UserList(UserIndex).flags.UltimoMensaje = 261
+            UserList(UserIndex).flags.UltimoMensaje = LASTMSG_PICKUP_UNAVAILABLE
         End If
     End If
     Exit Sub
 PickObj_Err:
     Call TraceError(Err.Number, Err.Description, "InvUsuario.PickObj", Erl)
 End Sub
 
 Sub Desequipar(ByVal UserIndex As Integer, ByVal Slot As Byte, Optional ByVal bSkin As Boolean = False, Optional ByVal eSkinType As e_OBJType)
 
 Dim obj                         As t_ObjData
 
     On Error GoTo Desequipar_Err
 
     With UserList(UserIndex)
 
         If Not bSkin Then
             'Desequipa el item slot del inventario
             If (Slot < LBound(.invent.Object)) Or (Slot > UBound(.invent.Object)) Then
                 Exit Sub
             ElseIf .invent.Object(Slot).ObjIndex = 0 Then
                 Exit Sub
             End If
 
             obj = ObjData(.invent.Object(Slot).ObjIndex)
 
diff --git a/Codigo/Modulo_UsUaRiOs.bas b/Codigo/Modulo_UsUaRiOs.bas
index e4283c868d71f95d305b2ef318089c907930de37..dd434a9809e7b61695b14164aa2436c75370a9ca 100644
--- a/Codigo/Modulo_UsUaRiOs.bas
+++ b/Codigo/Modulo_UsUaRiOs.bas
@@ -2087,53 +2087,53 @@ Sub WarpToLegalPos(ByVal UserIndex As Integer, _
                 If LegalPos(Map, tX, tY, AguaValida, True, UserList(UserIndex).flags.Montado = 1, False, False) Then
                     If MapData(Map, tX, tY).trigger < 50 Then
                         Call WarpUserChar(UserIndex, Map, tX, tY, FX)
                         Exit Sub
                     End If
                 End If
             Next tX
         Next tY
         LoopC = LoopC + 1
     Loop
     Call WarpUserChar(UserIndex, Map, x, y, FX)
     Exit Sub
 WarpToLegalPos_Err:
     Call TraceError(Err.Number, Err.Description, "UsUaRiOs.WarpToLegalPos", Erl)
 End Sub
 
 Sub WarpUserChar(ByVal UserIndex As Integer, ByVal Map As Integer, ByVal x As Integer, ByVal y As Integer, Optional ByVal FX As Boolean = False)
     On Error GoTo WarpUserChar_Err
     Dim OldMap As Integer
     Dim OldX   As Integer
     Dim OldY   As Integer
     With UserList(UserIndex)
         If Map <= 0 Then Exit Sub
         If Not EsGM(UserIndex) And Not IsPatreon(UserIndex) Then
             If TileRequiresPatreon(Map, x, y) Then
-                If .flags.UltimoMensaje <> 108 Then
+                If .flags.UltimoMensaje <> LASTMSG_TILE_REQUIRES_PATREON Then
                     Call WriteLocaleMsg(UserIndex, 776, e_FontTypeNames.FONTTYPE_INFO)
-                    .flags.UltimoMensaje = 108
+                    .flags.UltimoMensaje = LASTMSG_TILE_REQUIRES_PATREON
                 End If
                 Exit Sub
             End If
         End If
         If IsValidUserRef(.ComUsu.DestUsu) Then
             If UserList(.ComUsu.DestUsu.ArrayIndex).flags.UserLogged Then
                 If UserList(.ComUsu.DestUsu.ArrayIndex).ComUsu.DestUsu.ArrayIndex = UserIndex Then
                     'Msg1101= Comercio cancelado por el otro usuario
                     Call WriteLocaleMsg(.ComUsu.DestUsu.ArrayIndex, "1101", e_FontTypeNames.FONTTYPE_TALK)
                     Call FinComerciarUsu(.ComUsu.DestUsu.ArrayIndex)
                 End If
             End If
         End If
         'Quitar el dialogo
         Call SendData(SendTarget.ToPCArea, UserIndex, PrepareMessageRemoveCharDialog(.Char.charindex))
         Call WriteRemoveAllDialogs(UserIndex)
         OldMap = .pos.Map
         OldX = .pos.x
         OldY = .pos.y
         Call EraseUserChar(UserIndex, True, FX)
         If OldMap <> Map Then
             Call WriteChangeMap(UserIndex, Map)
             If MapInfo(OldMap).Seguro = 1 And MapInfo(Map).Seguro = 0 And .Stats.ELV < 42 Then
                 ' Msg573=Estás saliendo de una zona segura, recuerda que aquí corres riesgo de ser atacado.
                 Call WriteLocaleMsg(UserIndex, 573, e_FontTypeNames.FONTTYPE_WARNING)
diff --git a/Codigo/Protocol.bas b/Codigo/Protocol.bas
index 87b4fe1669acb7a0cb6afd43eaac64ce02fbf1e7..e86dbb2112f861532de476ce6822fb881cfad2fc 100644
--- a/Codigo/Protocol.bas
+++ b/Codigo/Protocol.bas
@@ -1527,52 +1527,52 @@ Private Sub HandleWalk(ByVal UserIndex As Integer)
                 If UserList(UserIndex).Grupo.EnGrupo Then
                     Call CompartirUbicacion(UserIndex)
                 End If
                 'Stop resting if needed
                 If .flags.Descansar Then
                     .flags.Descansar = False
                     Call WriteRestOK(UserIndex)
                     'Msg1121= Has dejado de descansar.
                     Call WriteLocaleMsg(UserIndex, 1121, e_FontTypeNames.FONTTYPE_INFO)
                     Call WriteLocaleMsg(UserIndex, 178, e_FontTypeNames.FONTTYPE_INFO)
                 End If
                 Call CancelExit(UserIndex)
                 'Esta usando el /HOGAR, no se puede mover
                 If .flags.Traveling = 1 Then
                     .flags.Traveling = 0
                     .Counters.goHome = 0
                     'Msg1122= Has cancelado el viaje a casa.
                     Call WriteLocaleMsg(UserIndex, 1122, e_FontTypeNames.FONTTYPE_INFO)
                 End If
                 ' Si no pudo moverse
             Else
                 .Counters.LastStep = 0
                 Call WritePosUpdate(UserIndex)
             End If
         Else    'paralized
-            If Not .flags.UltimoMensaje = 1 Then
-                .flags.UltimoMensaje = 1
+            If Not .flags.UltimoMensaje = LASTMSG_PARALYZED Then
+                .flags.UltimoMensaje = LASTMSG_PARALYZED
                 'Msg1123= No podes moverte porque estas paralizado.
                 Call WriteLocaleMsg(UserIndex, 1123, e_FontTypeNames.FONTTYPE_INFO)
                 Call WriteLocaleMsg(UserIndex, 54, e_FontTypeNames.FONTTYPE_INFO)
             End If
             Call WritePosUpdate(UserIndex)
         End If
         'Can't move while hidden except he is a thief
         If .flags.Oculto = 1 And .flags.AdminInvisible = 0 Then
             If .clase <> e_Class.Thief And .clase <> e_Class.Bandit Then
                 .flags.Oculto = 0
                 .Counters.TiempoOculto = 0
                 If .flags.Navegando = 1 Then
                     If .clase = e_Class.Pirat Then
                         ' Pierde la apariencia de fragata fantasmal
                         Call EquiparBarco(UserIndex)
                         ' Msg592=¡Has recuperado tu apariencia normal!
                         Call WriteLocaleMsg(UserIndex, 592, e_FontTypeNames.FONTTYPE_INFO)
                         Call ChangeUserChar(UserIndex, .Char.body, .Char.head, .Char.Heading, NingunArma, NingunEscudo, NingunCasco, NoCart, NoBackPack)
                         Call RefreshCharStatus(UserIndex)
                     End If
                 Else
                     'If not under a spell effect, show char
                     If .flags.invisible = 0 Then
                         'Msg1124= Has vuelto a ser visible.
                         Call WriteLocaleMsg(UserIndex, 1124, e_FontTypeNames.FONTTYPE_INFO)
@@ -2088,65 +2088,65 @@ HandleDoubleClick_Err:
     Call TraceError(Err.Number, Err.Description, "Protocol.HandleDoubleClick", Erl)
 End Sub
 
 Private Sub HandleWork(ByVal UserIndex As Integer)
     On Error GoTo HandleWork_Err
     With UserList(UserIndex)
         Dim Skill As e_Skill
         Skill = reader.ReadInt8()
         Dim PacketCounter As Long
         PacketCounter = reader.ReadInt32
         If UserList(UserIndex).flags.Muerto = 1 Then
             'Msg77=¡¡Estás muerto!!.
             Call WriteLocaleMsg(UserIndex, 77, e_FontTypeNames.FONTTYPE_INFO)
             Exit Sub
         End If
         'If exiting, cancel
         Call CancelExit(UserIndex)
         Select Case Skill
             Case Robar, Magia, Domar
                 Call WriteWorkRequestTarget(UserIndex, Skill)
             Case Ocultarse
                 If Not verifyTimeStamp(PacketCounter, .PacketCounters(PacketNames.Hide), .PacketTimers(PacketNames.Hide), .MacroIterations(PacketNames.Hide), UserIndex, _
                         "Ocultar", PacketTimerThreshold(PacketNames.Hide), MacroIterations(PacketNames.Hide)) Then Exit Sub
                 If .flags.Montado = 1 Then
                     '[CDT 17-02-2004]
-                    If Not .flags.UltimoMensaje = 3 Then
+                    If Not .flags.UltimoMensaje = LASTMSG_CANNOT_HIDE_MOUNTED Then
                         ' Msg704=No podés ocultarte si estás montado.
                         Call WriteLocaleMsg(UserIndex, 704, e_FontTypeNames.FONTTYPE_INFO)
-                        .flags.UltimoMensaje = 3
+                        .flags.UltimoMensaje = LASTMSG_CANNOT_HIDE_MOUNTED
                     End If
                     '[/CDT]
                     Exit Sub
                 End If
                 If .flags.Oculto = 1 Then
                     '[CDT 17-02-2004]
-                    If Not .flags.UltimoMensaje = 2 Then
+                    If Not .flags.UltimoMensaje = LASTMSG_ALREADY_HIDDEN Then
                         Call WriteLocaleMsg(UserIndex, 55, e_FontTypeNames.FONTTYPE_INFO)
                         'Msg1127= Ya estás oculto.
                         Call WriteLocaleMsg(UserIndex, 1127, e_FontTypeNames.FONTTYPE_INFO)
-                        .flags.UltimoMensaje = 2
+                        .flags.UltimoMensaje = LASTMSG_ALREADY_HIDDEN
                     End If
                     '[/CDT]
                     Exit Sub
                 End If
                 If .flags.EnReto Then
                     ' Msg705=No podés ocultarte durante un reto.
                     Call WriteLocaleMsg(UserIndex, 705, e_FontTypeNames.FONTTYPE_INFO)
                     Exit Sub
                 End If
                 If .flags.EnConsulta Then
                     ' Msg706=No podés ocultarte si estas en consulta.
                     Call WriteLocaleMsg(UserIndex, 706, e_FontTypeNames.FONTTYPE_INFO)
                     Exit Sub
                 End If
                 If .flags.invisible Then
                     ' Msg707=No podés ocultarte si estás invisible.
                     Call WriteLocaleMsg(UserIndex, 707, e_FontTypeNames.FONTTYPE_INFO)
                     Exit Sub
                 End If
                 If MapInfo(.pos.Map).SinInviOcul Then
                     ' Msg708=Una fuerza divina te impide ocultarte en esta zona.
                     Call WriteLocaleMsg(UserIndex, 708, e_FontTypeNames.FONTTYPE_INFO)
                     Exit Sub
                 End If
                 Call DoOcultarse(UserIndex)
@@ -2338,51 +2338,51 @@ Private Sub HandleWorkLeftClick(ByVal UserIndex As Integer)
             Case e_Skill.Proyectiles
                 Dim WeaponData     As t_ObjData
                 Dim ProjectileType As Byte
                 'Check attack interval
                 If Not IntervaloPermiteMagiaGolpe(UserIndex, False) Then Exit Sub
                 'Check Magic interval
                 If Not IntervaloPermiteGolpeMagia(UserIndex, False) Then Exit Sub
                 'Check bow's interval
                 If Not IntervaloPermiteUsarArcos(UserIndex) Then Exit Sub
                 'Make sure the item is valid and there is ammo equipped.
                 With .invent
                     If .EquippedWeaponObjIndex < 1 Then Exit Sub
                     WeaponData = ObjData(.EquippedWeaponObjIndex)
                     If IsItemInCooldown(UserList(UserIndex), .Object(.EquippedWeaponSlot)) Then Exit Sub
                     ProjectileType = GetProjectileView(UserList(UserIndex))
                     If WeaponData.Proyectil = 1 And WeaponData.Municion = 0 Then
                         DummyInt = 0
                     ElseIf .EquippedWeaponObjIndex = 0 Then
                         DummyInt = 1
                     ElseIf .EquippedWeaponSlot < 1 Or .EquippedWeaponSlot > UserList(UserIndex).CurrentInventorySlots Then
                         DummyInt = 1
                     ElseIf .EquippedMunitionSlot < 1 Or .EquippedMunitionSlot > UserList(UserIndex).CurrentInventorySlots Then
                         DummyInt = 1
                     ElseIf .EquippedMunitionObjIndex = 0 Then
                         DummyInt = 1
-                    ElseIf ObjData(.EquippedWeaponObjIndex).Proyectil <> 1 Then
+                    ElseIf ObjData(.EquippedWeaponObjIndex).Proyectil <> LASTMSG_PARALYZED Then
                         DummyInt = 2
                     ElseIf ObjData(.EquippedMunitionObjIndex).OBJType <> e_OBJType.otArrows Then
                         DummyInt = 1
                     ElseIf .Object(.EquippedMunitionSlot).amount < 1 Then
                         DummyInt = 1
                     ElseIf ObjData(.EquippedMunitionObjIndex).Subtipo <> WeaponData.Municion Then
                         DummyInt = 1
                     End If
                     If DummyInt <> 0 Then
                         If DummyInt = 1 Then
                             ' Msg709=No tenés municiones.
                             Call WriteLocaleMsg(UserIndex, 709, e_FontTypeNames.FONTTYPE_INFO)
                         End If
                         Call Desequipar(UserIndex, .EquippedMunitionSlot)
                         Call WriteWorkRequestTarget(UserIndex, 0)
                         Exit Sub
                     End If
                 End With
                 'Quitamos stamina
                 If .Stats.MinSta >= 10 Then
                     Call QuitarSta(UserIndex, RandomNumber(1, 10))
                 Else
                     Call WriteLocaleMsg(UserIndex, 93, e_FontTypeNames.FONTTYPE_INFO)
                     'Msg1128= Estís muy cansado para luchar.
                     Call WriteLocaleMsg(UserIndex, 1128, e_FontTypeNames.FONTTYPE_INFO)
diff --git a/Codigo/Trabajo.bas b/Codigo/Trabajo.bas
index 2c5739cb125e8ecdaa7dae2b3aa072e8fb3b6cf7..5cbc20e4ce1ec6052b32ddc7a546b9e80e545e31 100644
--- a/Codigo/Trabajo.bas
+++ b/Codigo/Trabajo.bas
@@ -369,54 +369,54 @@ Public Sub DoOcultarse(ByVal UserIndex As Integer)
                 Case e_Class.Bandit, e_Class.Thief
                     .Counters.TiempoOculto = RandomNumber(Int(Suerte / 2.5), Int(Suerte / 2))
                 Case e_Class.Hunter
                     .Counters.TiempoOculto = Int(Suerte / 2)
                 Case Else
                     .Counters.TiempoOculto = Int(Suerte / 3)
             End Select
             If .flags.Navegando = 1 Then
                 If .clase = e_Class.Pirat Then
                     .Char.body = iFragataFantasmal
                     .flags.Oculto = 1
                     .Counters.TiempoOculto = IntervaloOculto
                     Call ChangeUserChar(UserIndex, .Char.body, .Char.head, .Char.Heading, NingunArma, NingunEscudo, NingunCasco, NoCart, NoBackPack)
                     'Msg1024= ¡Te has camuflado como barco fantasma!
                     Call WriteLocaleMsg(UserIndex, 1024, e_FontTypeNames.FONTTYPE_INFO)
                     Call RefreshCharStatus(UserIndex)
                 End If
             Else
                 UserList(UserIndex).Counters.timeFx = 3
                 Call SendData(SendTarget.ToPCAliveArea, UserIndex, PrepareMessageSetInvisible(.Char.charindex, True, UserList(UserIndex).pos.x, UserList(UserIndex).pos.y))
                 'Msg55=¡Te has escondido entre las sombras!
                 Call WriteLocaleMsg(UserIndex, 55, e_FontTypeNames.FONTTYPE_INFO)
             End If
             Call SubirSkill(UserIndex, Ocultarse)
         Else
-            If Not .flags.UltimoMensaje = 4 Then
+            If Not .flags.UltimoMensaje = LASTMSG_HIDE_FAILED Then
                 'Msg57=¡No has logrado esconderte!
                 Call WriteLocaleMsg(UserIndex, 57, e_FontTypeNames.FONTTYPE_INFO)
-                .flags.UltimoMensaje = 4
+                .flags.UltimoMensaje = LASTMSG_HIDE_FAILED
             End If
         End If
         .Counters.Ocultando = .Counters.Ocultando + 1
     End With
     Exit Sub
 ErrHandler:
     Call LogError("Error en Sub DoOcultarse")
 End Sub
 
 Public Sub DoNavega(ByVal UserIndex As Integer, ByRef Barco As t_ObjData, ByVal Slot As Integer)
     On Error GoTo DoNavega_Err
     With UserList(UserIndex)
         If .invent.EquippedShipObjIndex <> .invent.Object(Slot).ObjIndex Then
             If Not EsGM(UserIndex) Then
                 Select Case Barco.Subtipo
                     Case 2  'Galera
                         If .clase <> e_Class.Trabajador And .clase <> e_Class.Pirat Then
                             'Msg1025= ¡Solo Piratas y trabajadores pueden usar galera!
                             Call WriteLocaleMsg(UserIndex, 1025, e_FontTypeNames.FONTTYPE_INFO)
                             Exit Sub
                         End If
                     Case 3  'Galeón
                         If .clase <> e_Class.Pirat Then
                             'Msg1026= Solo los Piratas pueden usar Galeón!!
                             Call WriteLocaleMsg(UserIndex, 1026, e_FontTypeNames.FONTTYPE_INFO)
@@ -1213,51 +1213,51 @@ End Function
 Public Sub CarpinteroConstruirItem(ByVal UserIndex As Integer, ByVal ItemIndex As Integer, ByVal Cantidad As Long, ByVal cantidad_maxima As Integer)
     On Error GoTo CarpinteroConstruirItem_Err
     If Not IntervaloPermiteTrabajarConstruir(UserIndex) Then Exit Sub
     If UserList(UserIndex).flags.Privilegios And (e_PlayerType.Consejero Or e_PlayerType.SemiDios Or e_PlayerType.Dios) Then
         Exit Sub
     End If
     If ItemIndex = 0 Then Exit Sub
     'Si no tiene equipado el serrucho
     If UserList(UserIndex).invent.EquippedWorkingToolObjIndex = 0 Then
         ' Antes de usar la herramienta deberias equipartela.
         Call WriteLocaleMsg(UserIndex, 376, e_FontTypeNames.FONTTYPE_INFO)
         Call WriteMacroTrabajoToggle(UserIndex, False)
         Exit Sub
     End If
     Dim cantidad_a_construir    As Long
     Dim madera_requerida        As Long
     Dim madera_elfica_requerida As Long
     Dim madera_pino_requerida   As Long
     cantidad_a_construir = IIf(UserList(UserIndex).Trabajo.Cantidad >= cantidad_maxima, cantidad_maxima, UserList(UserIndex).Trabajo.Cantidad)
     If cantidad_a_construir <= 0 Then
         Call WriteMacroTrabajoToggle(UserIndex, False)
         Exit Sub
     End If
     If CarpinteroTieneMateriales(UserIndex, ItemIndex, cantidad_a_construir) And UserList(UserIndex).Stats.UserSkills(e_Skill.Carpinteria) >= ObjData(ItemIndex).SkCarpinteria _
             And PuedeConstruirCarpintero(ItemIndex) And ObjData(UserList(UserIndex).invent.EquippedWorkingToolObjIndex).OBJType = e_OBJType.otWorkingTools And ObjData(UserList( _
-            UserIndex).invent.EquippedWorkingToolObjIndex).Subtipo = 5 Then
+            UserIndex).invent.EquippedWorkingToolObjIndex).Subtipo = LASTMSG_TAME_FAILED Then
         If UserList(UserIndex).Stats.MinSta > 2 Then
             Call QuitarSta(UserIndex, 2)
         Else
             Call WriteLocaleMsg(UserIndex, 93, e_FontTypeNames.FONTTYPE_INFO)
             'Msg93=Estás muy cansado para trabajar.
             Call WriteMacroTrabajoToggle(UserIndex, False)
             Exit Sub
         End If
         If ObjData(ItemIndex).Madera > 0 Then madera_requerida = ObjData(ItemIndex).Madera * cantidad_a_construir
         If ObjData(ItemIndex).MaderaElfica > 0 Then madera_elfica_requerida = ObjData(ItemIndex).MaderaElfica * cantidad_a_construir
         If ObjData(ItemIndex).MaderaPino > 0 Then madera_pino_requerida = ObjData(ItemIndex).MaderaPino * cantidad_a_construir
         Call CarpinteroQuitarMateriales(UserIndex, ItemIndex, madera_requerida, madera_elfica_requerida, madera_pino_requerida)
         UserList(UserIndex).Trabajo.Cantidad = UserList(UserIndex).Trabajo.Cantidad - cantidad_a_construir
         Call WriteTextCharDrop(UserIndex, "+" & cantidad_a_construir, UserList(UserIndex).Char.charindex, vbWhite)
         Dim MiObj As t_Obj
         MiObj.amount = cantidad_a_construir
         MiObj.ObjIndex = ItemIndex
         MiObj.ElementalTags = ObjData(ItemIndex).ElementalTags
         ' AGREGAR FX
         Call SendData(SendTarget.ToIndex, UserIndex, PrepareMessageParticleFX(UserList(UserIndex).Char.charindex, 253, 25, False, ObjData(MiObj.ObjIndex).GrhIndex))
         If Not MeterItemEnInventario(UserIndex, MiObj) Then
             Call TirarItemAlPiso(UserList(UserIndex).pos, MiObj)
         End If
         Call SubirSkill(UserIndex, e_Skill.Carpinteria)
         If IsFeatureEnabled("gain_exp_while_working") Then
@@ -1698,51 +1698,51 @@ Public Sub DoRobar(ByVal LadronIndex As Integer, ByVal VictimaIndex As Integer)
                     End If
                 Else '50% de robar oro
                     If UserList(VictimaIndex).Stats.GLD > 0 Then
                         Dim n     As Long
                         Dim Extra As Single
                         ' Multiplicador extra por niveles
                         Select Case .Stats.ELV
                             Case Is < 13
                                 Extra = 1
                             Case Is < 25
                                 Extra = 1.1
                             Case Is < 35
                                 Extra = 1.2
                             Case Is >= 35 And .Stats.ELV <= 40
                                 Extra = 1.3
                             Case Is >= 41 And .Stats.ELV < 45
                                 Extra = 1.4
                             Case Is >= 45 And .Stats.ELV <= 46
                                 Extra = 1.5
                             Case Is = 47
                                 Extra = 5
                         End Select
                         If .clase = e_Class.Thief Then
                             'Si no tiene puestos los guantes de hurto roba un 50% menos.
                             If .invent.EquippedWeaponObjIndex > 0 Then
-                                If ObjData(.invent.EquippedWeaponObjIndex).Subtipo = 5 Then
+                                If ObjData(.invent.EquippedWeaponObjIndex).Subtipo = LASTMSG_TAME_FAILED Then
                                     n = RandomNumber(.Stats.ELV * 50 * Extra, .Stats.ELV * 100 * Extra) * SvrConfig.GetValue("GoldMult")
                                 Else
                                     n = RandomNumber(.Stats.ELV * 25 * Extra, .Stats.ELV * 50 * Extra) * SvrConfig.GetValue("GoldMult")
                                 End If
                             Else
                                 n = RandomNumber(.Stats.ELV * 25 * Extra, .Stats.ELV * 50 * Extra) * SvrConfig.GetValue("GoldMult")
                             End If
                         Else
                             n = RandomNumber(1, 100) * SvrConfig.GetValue("GoldMult")
                         End If
                         If n > UserList(VictimaIndex).Stats.GLD Then n = UserList(VictimaIndex).Stats.GLD
                         Dim prevGold As Long: prevGold = UserList(VictimaIndex).Stats.GLD
                         UserList(VictimaIndex).Stats.GLD = UserList(VictimaIndex).Stats.GLD - n
                         Dim ProtectedGold As Long
                         ProtectedGold = SvrConfig.GetValue("OroPorNivelBilletera") * UserList(VictimaIndex).Stats.ELV
                         If prevGold >= ProtectedGold And UserList(VictimaIndex).Stats.GLD < ProtectedGold Then
                             n = prevGold - ProtectedGold
                             UserList(VictimaIndex).Stats.GLD = ProtectedGold
                         End If
                         .Stats.GLD = .Stats.GLD + n
                         If .Stats.GLD > MAXORO Then .Stats.GLD = MAXORO
                         Call WriteLocaleMsg(LadronIndex, "1458", e_FontTypeNames.FONTTYPE_New_Rojo_Salmon, PonerPuntos(n) & "¬" & UserList(VictimaIndex).name) ' Msg1458=Le has robado ¬1 monedas de oro a ¬2
                         Call WriteLocaleMsg(VictimaIndex, "1530", e_FontTypeNames.FONTTYPE_New_Rojo_Salmon, UserList(LadronIndex).name & "¬" & PonerPuntos(n)) 'Msg1530=¬1 te ha robado ¬2 monedas de oro.
                         Call WriteUpdateGold(LadronIndex) 'Le actualizamos la billetera al ladron
                         Call WriteUpdateGold(VictimaIndex) 'Le actualizamos la billetera a la victima
@@ -1967,51 +1967,51 @@ Public Sub DoMineria(ByVal UserIndex As Integer, ByVal x As Byte, ByVal y As Byt
     Dim res        As Integer
     Dim Metal      As Integer
     Dim Yacimiento As t_ObjData
     With UserList(UserIndex)
         If .flags.Privilegios And (e_PlayerType.Consejero) Then
             Exit Sub
         End If
         If .Stats.MinSta > 5 Then
             Call QuitarSta(UserIndex, 5)
         Else
             Call WriteLocaleMsg(UserIndex, 93, e_FontTypeNames.FONTTYPE_INFO)
             Call WriteMacroTrabajoToggle(UserIndex, False)
             Exit Sub
         End If
         Dim Skill As Integer
         Skill = .Stats.UserSkills(e_Skill.Mineria)
         Suerte = Int(-0.00125 * Skill * Skill - 0.3 * Skill + 49)
         'HarThaoS: Le agrego más dificultad al talar en zona segura.  37% probabilidad de fallo en segura vs 16% en insegura
         res = RandomNumber(1, IIf(MapInfo(UserList(UserIndex).pos.Map).Seguro = 1, Suerte + 2, Suerte))
         '118         Call SendData(SendTarget.ToPCArea, UserIndex, PrepareMessageArmaMov(.Char.CharIndex))
         'ReyarB: aumento chances solamente si es mineria de blodium.
         If ObjData(MapData(.pos.Map, x, y).ObjInfo.ObjIndex).MineralIndex = 3787 Then
             res = 1
             Suerte = 100
         End If
-        If res <= 5 Then
+        If res <= LASTMSG_TAME_FAILED Then
             Dim MiObj As t_Obj
             Dim nPos  As t_WorldPos
             Call ActualizarRecurso(.pos.Map, x, y)
             MapData(.pos.Map, x, y).ObjInfo.data = GetTickCountRaw() ' Ultimo uso
             Yacimiento = ObjData(MapData(.pos.Map, x, y).ObjInfo.ObjIndex)
             MiObj.ObjIndex = Yacimiento.MineralIndex
             If .clase = Trabajador Then
                 MiObj.amount = GetExtractResourceForLevel(.Stats.ELV)
             Else
                 MiObj.amount = RandomNumber(1, 2)
             End If
             MiObj.amount = MiObj.amount * SvrConfig.GetValue("RecoleccionMult")
             If MiObj.amount > MapData(.pos.Map, x, y).ObjInfo.amount Then
                 MiObj.amount = MapData(.pos.Map, x, y).ObjInfo.amount
             End If
             MapData(.pos.Map, x, y).ObjInfo.amount = MapData(.pos.Map, x, y).ObjInfo.amount - MiObj.amount
             If Not MeterItemEnInventario(UserIndex, MiObj) Then Call TirarItemAlPiso(.pos, MiObj)
             ' AGREGAR FX
             Call SendData(SendTarget.ToIndex, UserIndex, PrepareMessageParticleFX(.Char.charindex, 253, 25, False, ObjData(MiObj.ObjIndex).GrhIndex))
             Call WriteTextCharDrop(UserIndex, "+" & MiObj.amount, .Char.charindex, vbWhite)
             ' Msg651=¡Has extraído algunos minerales!
             Call WriteLocaleMsg(UserIndex, 651, e_FontTypeNames.FONTTYPE_INFO)
             If MapInfo(.pos.Map).Seguro = 1 Then
                 Call SendData(SendTarget.ToIndex, UserIndex, PrepareMessagePlayWave(15, .pos.x, .pos.y))
             Else
@@ -2319,54 +2319,54 @@ Sub DoDomar(ByVal UserIndex As Integer, ByVal NpcIndex As Integer)
                 Exit Sub
             End If
             If NpcList(NpcIndex).flags.Domable <= puntosDomar And RandomNumber(1, 5) = 1 Then
                 Dim Index As Integer
                 .NroMascotas = .NroMascotas + 1
                 Index = FreeMascotaIndex(UserIndex)
                 Call SetNpcRef(.MascotasIndex(Index), NpcIndex)
                 .MascotasType(Index) = NpcList(NpcIndex).Numero
                 Call SetUserRef(NpcList(NpcIndex).MaestroUser, UserIndex)
                 .flags.ModificoMascotas = True
                 Call FollowAmo(NpcIndex)
                 Call ReSpawnNpc(NpcList(NpcIndex))
                 ' Msg657=La criatura te ha aceptado como su amo.
                 Call WriteLocaleMsg(UserIndex, 657, e_FontTypeNames.FONTTYPE_INFO)
                 ' Es zona segura?
                 If MapInfo(.pos.Map).NoMascotas = 1 Then
                     petType = NpcList(NpcIndex).Numero
                     NroPets = .NroMascotas
                     Call QuitarNPC(NpcIndex, eNewPet)
                     .MascotasType(Index) = petType
                     .NroMascotas = NroPets
                     ' Msg658=No se permiten mascotas en zona segura. estas te esperaran afuera.
                     Call WriteLocaleMsg(UserIndex, 658, e_FontTypeNames.FONTTYPE_INFO)
                 End If
             Else
-                If Not .flags.UltimoMensaje = 5 Then
+                If Not .flags.UltimoMensaje = LASTMSG_TAME_FAILED Then
                     ' Msg659=No has logrado domar la criatura.
                     Call WriteLocaleMsg(UserIndex, 659, e_FontTypeNames.FONTTYPE_INFO)
-                    .flags.UltimoMensaje = 5
+                    .flags.UltimoMensaje = LASTMSG_TAME_FAILED
                 End If
             End If
             Call SubirSkill(UserIndex, e_Skill.Domar)
         Else
             ' Msg660=No puedes controlar mas criaturas.
             Call WriteLocaleMsg(UserIndex, 660, e_FontTypeNames.FONTTYPE_INFO)
         End If
     End With
     Exit Sub
 ErrHandler:
     Call LogError("Error en DoDomar. Error " & Err.Number & " : " & Err.Description)
 End Sub
 
 ''
 ' Checks if the user can tames a pet.
 '
 ' @param integer userIndex The user id from who wants tame the pet.
 ' @param integer NPCindex The index of the npc to tome.
 ' @return boolean True if can, false if not.
 Private Function PuedeDomarMascota(ByVal UserIndex As Integer, ByVal NpcIndex As Integer) As Boolean
     On Error GoTo PuedeDomarMascota_Err
     '***************************************************
     'Author: ZaMa
     'This function checks how many NPCs of the same type have
     'been tamed by the user.

